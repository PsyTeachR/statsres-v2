<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="description" content="Materials for the MSc Statistics and Research Design course at the University of Glasgow.">
<title>7&nbsp; Perspectives on group comparisons – Statistics and Research Design</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./02-07-gar-ci.html" rel="prev">
<link href="./images/logos/favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-6NP3MF25W3"></script><script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-6NP3MF25W3', { 'anonymize_ip': true});
</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.13.0/css/all.css">
<link rel="stylesheet" href="include/booktem.css">
<link rel="stylesheet" href="include/webex.css">
<link rel="stylesheet" href="include/glossary.css">
<link rel="stylesheet" href="include/style.css">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./02-00-graph_robust.html">Graphical representations and robust statistics</a></li><li class="breadcrumb-item"><a href="./02-08-gar-gpcomp.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Perspectives on group comparisons</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Statistics and Research Design</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./01-00-GLM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General linear model</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-01-lm-continuous.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Regression with one continuous predictor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-02-lm-categorical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Regression with one categorical predictor</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-03-lm-multiple.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Multiple Linear Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-04-screening-data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Missing data, outliers, and checking assumptions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-05-glm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Generalised Linear Regression</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./02-00-graph_robust.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Graphical representations and robust statistics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-07-gar-ci.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Confidence Intervals</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-08-gar-gpcomp.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Perspectives on group comparisons</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-a-installing-brms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Installing the <code>brms</code> package</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li>
<a href="#chapter-preparation" id="toc-chapter-preparation" class="nav-link active" data-scroll-target="#chapter-preparation"><span class="header-section-number">7.1</span> Chapter preparation</a>
  <ul class="collapse">
<li><a href="#organising-your-files-and-project-for-the-chapter" id="toc-organising-your-files-and-project-for-the-chapter" class="nav-link" data-scroll-target="#organising-your-files-and-project-for-the-chapter"><span class="header-section-number">7.1.1</span> Organising your files and project for the chapter</a></li>
  </ul>
</li>
  <li><a href="#dependencies" id="toc-dependencies" class="nav-link" data-scroll-target="#dependencies"><span class="header-section-number">7.2</span> Dependencies</a></li>
  <li>
<a href="#example-within-x-between-design" id="toc-example-within-x-between-design" class="nav-link" data-scroll-target="#example-within-x-between-design"><span class="header-section-number">7.3</span> Example: within x between design</a>
  <ul class="collapse">
<li><a href="#load-data" id="toc-load-data" class="nav-link" data-scroll-target="#load-data"><span class="header-section-number">7.3.1</span> Load data</a></li>
  <li><a href="#bar-graph" id="toc-bar-graph" class="nav-link" data-scroll-target="#bar-graph"><span class="header-section-number">7.3.2</span> Bar graph</a></li>
  <li><a href="#d-scatterplots-stripcharts-of-differences" id="toc-d-scatterplots-stripcharts-of-differences" class="nav-link" data-scroll-target="#d-scatterplots-stripcharts-of-differences"><span class="header-section-number">7.3.3</span> 1D scatterplots = stripcharts of differences</a></li>
  <li><a href="#stripchart-linked-observations" id="toc-stripchart-linked-observations" class="nav-link" data-scroll-target="#stripchart-linked-observations"><span class="header-section-number">7.3.4</span> Stripchart + linked observations</a></li>
  <li><a href="#scatterplot-of-paired-observations" id="toc-scatterplot-of-paired-observations" class="nav-link" data-scroll-target="#scatterplot-of-paired-observations"><span class="header-section-number">7.3.5</span> Scatterplot of paired observations</a></li>
  </ul>
</li>
  <li>
<a href="#examples-of-standard-group-statistics" id="toc-examples-of-standard-group-statistics" class="nav-link" data-scroll-target="#examples-of-standard-group-statistics"><span class="header-section-number">7.4</span> Examples of standard group statistics</a>
  <ul class="collapse">
<li><a href="#x-2-anova" id="toc-x-2-anova" class="nav-link" data-scroll-target="#x-2-anova"><span class="header-section-number">7.4.1</span> 2 x 2 ANOVA</a></li>
  <li><a href="#group-1-t-test" id="toc-group-1-t-test" class="nav-link" data-scroll-target="#group-1-t-test"><span class="header-section-number">7.4.2</span> Group 1 t-test</a></li>
  <li><a href="#group-2-t-test" id="toc-group-2-t-test" class="nav-link" data-scroll-target="#group-2-t-test"><span class="header-section-number">7.4.3</span> Group 2 t-test</a></li>
  <li><a href="#make-final-figure-combining-4-panels" id="toc-make-final-figure-combining-4-panels" class="nav-link" data-scroll-target="#make-final-figure-combining-4-panels"><span class="header-section-number">7.4.4</span> Make final figure combining 4 panels</a></li>
  </ul>
</li>
  <li>
<a href="#inferences-for-all-pairwise-differences" id="toc-inferences-for-all-pairwise-differences" class="nav-link" data-scroll-target="#inferences-for-all-pairwise-differences"><span class="header-section-number">7.5</span> Inferences for all pairwise differences</a>
  <ul class="collapse">
<li><a href="#more-details-about-inferences-on-all-pairwise-differences" id="toc-more-details-about-inferences-on-all-pairwise-differences" class="nav-link" data-scroll-target="#more-details-about-inferences-on-all-pairwise-differences"><span class="header-section-number">7.5.1</span> More details about inferences on all pairwise differences</a></li>
  </ul>
</li>
  <li>
<a href="#two-dependent-groups-learning-experiment" id="toc-two-dependent-groups-learning-experiment" class="nav-link" data-scroll-target="#two-dependent-groups-learning-experiment"><span class="header-section-number">7.6</span> Two dependent groups: learning experiment</a>
  <ul class="collapse">
<li><a href="#simulate-data-from-n-participants" id="toc-simulate-data-from-n-participants" class="nav-link" data-scroll-target="#simulate-data-from-n-participants"><span class="header-section-number">7.6.1</span> Simulate data from n participants</a></li>
  <li><a href="#illustrate-results" id="toc-illustrate-results" class="nav-link" data-scroll-target="#illustrate-results"><span class="header-section-number">7.6.2</span> Illustrate results</a></li>
  <li><a href="#d-scatterplot-stripchart-of-differences" id="toc-d-scatterplot-stripchart-of-differences" class="nav-link" data-scroll-target="#d-scatterplot-stripchart-of-differences"><span class="header-section-number">7.6.3</span> 1D scatterplot = stripchart of differences</a></li>
  </ul>
</li>
  <li><a href="#compare-marginals" id="toc-compare-marginals" class="nav-link" data-scroll-target="#compare-marginals"><span class="header-section-number">7.7</span> Compare marginals</a></li>
  <li>
<a href="#quantify-within-participant-differences" id="toc-quantify-within-participant-differences" class="nav-link" data-scroll-target="#quantify-within-participant-differences"><span class="header-section-number">7.8</span> Quantify within participant differences</a>
  <ul class="collapse">
<li><a href="#summary-statistics" id="toc-summary-statistics" class="nav-link" data-scroll-target="#summary-statistics"><span class="header-section-number">7.8.1</span> Summary statistics</a></li>
  <li><a href="#bootstrap-test" id="toc-bootstrap-test" class="nav-link" data-scroll-target="#bootstrap-test"><span class="header-section-number">7.8.2</span> Bootstrap test</a></li>
  <li><a href="#pdiff-0" id="toc-pdiff-0" class="nav-link" data-scroll-target="#pdiff-0"><span class="header-section-number">7.8.3</span> <span class="math inline">\(P(diff &gt; 0)\)</span></a></li>
  <li><a href="#pdiff-0-confidence-interval" id="toc-pdiff-0-confidence-interval" class="nav-link" data-scroll-target="#pdiff-0-confidence-interval"><span class="header-section-number">7.8.4</span> <span class="math inline">\(P(diff &gt; 0)\)</span> + confidence interval</a></li>
  </ul>
</li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">7.9</span> References</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./02-00-graph_robust.html">Graphical representations and robust statistics</a></li><li class="breadcrumb-item"><a href="./02-08-gar-gpcomp.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Perspectives on group comparisons</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Perspectives on group comparisons</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="chapter-preparation" class="level2" data-number="7.1"><h2 data-number="7.1" class="anchored" data-anchor-id="chapter-preparation">
<span class="header-section-number">7.1</span> Chapter preparation</h2>
<p>In this chapter, we need a few different datasets and source files, so we will introduce them as we need them.</p>
<section id="organising-your-files-and-project-for-the-chapter" class="level3" data-number="7.1.1"><h3 data-number="7.1.1" class="anchored" data-anchor-id="organising-your-files-and-project-for-the-chapter">
<span class="header-section-number">7.1.1</span> Organising your files and project for the chapter</h3>
<p>Before we can get started, you need to organise your files and project for the chapter, so your working directory is in order.</p>
<ol type="1">
<li><p>In your folder for statistics and research design <code>Stats_Research_Design</code>, create a new folder called <code>08_group_comparisons</code>.</p></li>
<li><p>We are working with a few data sets and source files in this chapter, so please save the following zip file containing all the files you need: <a href="data/07_files.zip">Chapter 07 Files</a>. These are all the same as Chapter 7, so you can copy and paste it from your previous chapter if you already have them saved. Right click the link and select “save link as”, or clicking the link will save the file to your Downloads. Extra the files and save the two folders (<code>data</code> and <code>code</code>) in your <code>08_group_comparisons</code> folder. All the code in this chapter assumes these two folders with all their files inside are in the same folder as your Quarto document.</p></li>
<li><p>Create an R Project for <code>08_group_comparisons</code> as an existing directory for your chapter folder. This should now be your working directory.</p></li>
<li><p>Create a new Quarto document and give it a sensible title describing the chapter, such as <code>08 Perspectives on Group Comparisons</code>. Save the file in your <code>08_group_comparisons</code> folder.</p></li>
</ol>
<p>You are now ready to start working on the chapter!</p>
</section></section><section id="dependencies" class="level2" data-number="7.2"><h2 data-number="7.2" class="anchored" data-anchor-id="dependencies">
<span class="header-section-number">7.2</span> Dependencies</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">library</span>(tibble)</span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co"># devtools::install_github("debruine/faux")</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">library</span>(faux)</span>
<span id="cb1-6"><a href="#cb1-6"></a></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="fu">source</span>(<span class="st">"code/theme_gar.txt"</span>)</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="fu">source</span>(<span class="st">"code/Rallfun-v35-light.txt"</span>)</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="fu">source</span>(<span class="st">"code/summarySE.txt"</span>) <span class="co"># Define summary function</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co"># Code from: </span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="co"># http://www.cookbook-r.com/Graphs/Plotting_means_and_error_bars_(ggplot2)/</span></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="fu">library</span>(plyr)</span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="fu">library</span>(cowplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="example-within-x-between-design" class="level2" data-number="7.3"><h2 data-number="7.3" class="anchored" data-anchor-id="example-within-x-between-design">
<span class="header-section-number">7.3</span> Example: within x between design</h2>
<p>The example is from a 2016 editorial published in the <a href="https://onlinelibrary.wiley.com/doi/full/10.1111/ejn.13400">European Journal of Neuroscience</a>.</p>
<section id="load-data" class="level3" data-number="7.3.1"><h3 data-number="7.3.1" class="anchored" data-anchor-id="load-data">
<span class="header-section-number">7.3.1</span> Load data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/ejn_data.csv"</span>,<span class="at">header=</span>T)</span>
<span id="cb2-2"><a href="#cb2-2"></a>data<span class="sc">$</span>participant <span class="ot">&lt;-</span> <span class="fu">factor</span>(data<span class="sc">$</span>participant)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="bar-graph" class="level3" data-number="7.3.2"><h3 data-number="7.3.2" class="anchored" data-anchor-id="bar-graph">
<span class="header-section-number">7.3.2</span> Bar graph</h3>
<p>Making a bar graph in <code>ggplot2</code> is actually harder than making a more informative alternative.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>datas <span class="ot">&lt;-</span> <span class="fu">summarySE</span>(data, <span class="at">measurevar=</span><span class="st">"value"</span>, <span class="at">groupvars=</span><span class="fu">c</span>(<span class="st">"group"</span>,<span class="st">"condition"</span>))</span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a>bargraph <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(datas, <span class="fu">aes</span>(<span class="at">x=</span>group, <span class="at">y=</span>value, <span class="at">fill=</span>condition)) <span class="sc">+</span> </span>
<span id="cb3-4"><a href="#cb3-4"></a>  <span class="fu">theme_linedraw</span>() <span class="sc">+</span></span>
<span id="cb3-5"><a href="#cb3-5"></a>  <span class="fu">geom_bar</span>(<span class="at">position=</span><span class="fu">position_dodge</span>(), <span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">colour=</span><span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>value<span class="sc">-</span>se, <span class="at">ymax=</span>value<span class="sc">+</span>se),</span>
<span id="cb3-7"><a href="#cb3-7"></a>                <span class="at">width=</span>.<span class="dv">2</span>,                    <span class="co"># Width of the error bars</span></span>
<span id="cb3-8"><a href="#cb3-8"></a>                <span class="at">position=</span><span class="fu">position_dodge</span>(.<span class="dv">9</span>)) <span class="sc">+</span></span>
<span id="cb3-9"><a href="#cb3-9"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>)) <span class="sc">+</span></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">"grey20"</span>,<span class="at">size=</span><span class="dv">16</span>),</span>
<span id="cb3-11"><a href="#cb3-11"></a>      <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">"grey20"</span>,<span class="at">size=</span><span class="dv">16</span>),  </span>
<span id="cb3-12"><a href="#cb3-12"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb3-13"><a href="#cb3-13"></a>      <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb3-14"><a href="#cb3-14"></a>      <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb3-15"><a href="#cb3-15"></a>      <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">"grey20"</span>,<span class="at">size=</span><span class="dv">16</span>),</span>
<span id="cb3-16"><a href="#cb3-16"></a>      <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>,<span class="at">linewidth=</span>.<span class="dv">1</span>),</span>
<span id="cb3-17"><a href="#cb3-17"></a>      <span class="at">legend.position.inside =</span> <span class="fu">c</span>(.<span class="dv">15</span>, .<span class="dv">90</span>),</span>
<span id="cb3-18"><a href="#cb3-18"></a>      <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">5.5</span>,<span class="fl">5.5</span>,<span class="fl">5.5</span>,<span class="fl">5.5</span>), <span class="st">"pt"</span>),</span>
<span id="cb3-19"><a href="#cb3-19"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">"grey20"</span>,<span class="at">size=</span><span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb3-20"><a href="#cb3-20"></a>      <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Mean +/- SEM"</span>) <span class="sc">+</span></span>
<span id="cb3-21"><a href="#cb3-21"></a>      <span class="fu">scale_y_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">15</span>),<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb3-22"><a href="#cb3-22"></a> <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">position =</span> <span class="st">"inside"</span>))</span>
<span id="cb3-23"><a href="#cb3-23"></a></span>
<span id="cb3-24"><a href="#cb3-24"></a>bargraph</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="02-08-gar-gpcomp_files/figure-html/bar_graph-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="d-scatterplots-stripcharts-of-differences" class="level3" data-number="7.3.3"><h3 data-number="7.3.3" class="anchored" data-anchor-id="d-scatterplots-stripcharts-of-differences">
<span class="header-section-number">7.3.3</span> 1D scatterplots = stripcharts of differences</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>value <span class="ot">&lt;-</span> data<span class="sc">$</span>value[data<span class="sc">$</span>condition<span class="sc">==</span><span class="st">"condition2"</span>]<span class="sc">-</span>data<span class="sc">$</span>value[data<span class="sc">$</span>condition<span class="sc">==</span><span class="st">"condition1"</span>]</span>
<span id="cb4-2"><a href="#cb4-2"></a>participant <span class="ot">&lt;-</span> data<span class="sc">$</span>participant[data<span class="sc">$</span>condition<span class="sc">==</span><span class="st">"condition2"</span>]</span>
<span id="cb4-3"><a href="#cb4-3"></a>group <span class="ot">&lt;-</span> data<span class="sc">$</span>group[data<span class="sc">$</span>condition<span class="sc">==</span><span class="st">"condition2"</span>]</span>
<span id="cb4-4"><a href="#cb4-4"></a>diff <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(participant,group,value)</span>
<span id="cb4-5"><a href="#cb4-5"></a></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="fu">set.seed</span>(<span class="dv">8</span>)</span>
<span id="cb4-7"><a href="#cb4-7"></a></span>
<span id="cb4-8"><a href="#cb4-8"></a>diffstrip <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(diff, <span class="fu">aes</span>(<span class="at">x=</span>group, <span class="at">y=</span>value, <span class="at">fill=</span>group, <span class="at">colour=</span>group, <span class="at">shape=</span>group)) <span class="sc">+</span> <span class="fu">theme_linedraw</span>() <span class="sc">+</span></span>
<span id="cb4-9"><a href="#cb4-9"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb4-10"><a href="#cb4-10"></a>  <span class="fu">geom_jitter</span>(<span class="at">position=</span><span class="fu">position_jitter</span>(<span class="fl">0.1</span>), <span class="at">size=</span><span class="dv">4</span>, <span class="at">stroke=</span><span class="dv">1</span>, <span class="at">alpha=</span><span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb4-11"><a href="#cb4-11"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="dv">22</span>,<span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb4-12"><a href="#cb4-12"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"grey70"</span>, <span class="st">"grey95"</span>)) <span class="sc">+</span></span>
<span id="cb4-13"><a href="#cb4-13"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"grey5"</span>,<span class="st">"grey5"</span>)) <span class="sc">+</span></span>
<span id="cb4-14"><a href="#cb4-14"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>,</span>
<span id="cb4-15"><a href="#cb4-15"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">"grey20"</span>,<span class="at">size=</span><span class="dv">16</span>),</span>
<span id="cb4-16"><a href="#cb4-16"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">"grey20"</span>,<span class="at">size=</span><span class="dv">16</span>),  </span>
<span id="cb4-17"><a href="#cb4-17"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb4-18"><a href="#cb4-18"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb4-19"><a href="#cb4-19"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">"grey20"</span>,<span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb4-20"><a href="#cb4-20"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">5.5</span>,<span class="fl">5.5</span>,<span class="fl">5.5</span>,<span class="fl">5.5</span>), <span class="st">"pt"</span>)) <span class="sc">+</span></span>
<span id="cb4-21"><a href="#cb4-21"></a>        <span class="co"># plot.margin = unit(c(150,200,5.5,5.5), "pt")</span></span>
<span id="cb4-22"><a href="#cb4-22"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Differences: condition 2 - condition 1"</span>) <span class="sc">+</span></span>
<span id="cb4-23"><a href="#cb4-23"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">2.5</span>, <span class="fl">3.5</span>),<span class="at">breaks=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">1</span>)) </span>
<span id="cb4-24"><a href="#cb4-24"></a></span>
<span id="cb4-25"><a href="#cb4-25"></a>diffstrip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="02-08-gar-gpcomp_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="stripchart-linked-observations" class="level3" data-number="7.3.4"><h3 data-number="7.3.4" class="anchored" data-anchor-id="stripchart-linked-observations">
<span class="header-section-number">7.3.4</span> Stripchart + linked observations</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x=</span>condition, <span class="at">y=</span>value, <span class="at">fill=</span>condition, <span class="at">group=</span>participant,<span class="at">shape=</span>group)) <span class="sc">+</span> <span class="fu">theme_linedraw</span>() <span class="sc">+</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth=</span><span class="dv">1</span>, <span class="at">alpha=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>  <span class="fu">geom_point</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">stroke =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="dv">22</span>,<span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>)) <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">"grey20"</span>,<span class="at">size=</span><span class="dv">16</span>),</span>
<span id="cb5-7"><a href="#cb5-7"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">"grey20"</span>,<span class="at">size=</span><span class="dv">16</span>),  </span>
<span id="cb5-8"><a href="#cb5-8"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb5-9"><a href="#cb5-9"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb5-10"><a href="#cb5-10"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">"grey20"</span>,<span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb5-11"><a href="#cb5-11"></a>        <span class="at">legend.position=</span><span class="st">"none"</span>,</span>
<span id="cb5-12"><a href="#cb5-12"></a>        <span class="co"># plot.margin = unit(c(150,100,5.5,5.5), "pt")</span></span>
<span id="cb5-13"><a href="#cb5-13"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">5.5</span>,<span class="fl">5.5</span>,<span class="fl">5.5</span>,<span class="fl">5.5</span>), <span class="st">"pt"</span>)) <span class="sc">+</span></span>
<span id="cb5-14"><a href="#cb5-14"></a>        <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Paired observations"</span>) <span class="sc">+</span></span>
<span id="cb5-15"><a href="#cb5-15"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">20</span>),<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">20</span>,<span class="dv">5</span>))</span>
<span id="cb5-16"><a href="#cb5-16"></a></span>
<span id="cb5-17"><a href="#cb5-17"></a><span class="co"># p</span></span>
<span id="cb5-18"><a href="#cb5-18"></a>linkedstrip <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="fu">facet_grid</span>(. <span class="sc">~</span> group) <span class="sc">+</span></span>
<span id="cb5-19"><a href="#cb5-19"></a>  <span class="fu">theme</span>(<span class="at">strip.text.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">20</span>, <span class="at">colour =</span> <span class="st">"white"</span>),</span>
<span id="cb5-20"><a href="#cb5-20"></a>        <span class="at">strip.background =</span> <span class="fu">element_rect</span>(<span class="at">colour=</span><span class="st">"darkgrey"</span>, <span class="at">fill=</span><span class="st">"darkgrey"</span>))</span>
<span id="cb5-21"><a href="#cb5-21"></a></span>
<span id="cb5-22"><a href="#cb5-22"></a>linkedstrip</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="02-08-gar-gpcomp_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="scatterplot-of-paired-observations" class="level3" data-number="7.3.5"><h3 data-number="7.3.5" class="anchored" data-anchor-id="scatterplot-of-paired-observations">
<span class="header-section-number">7.3.5</span> Scatterplot of paired observations</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>condition1 <span class="ot">&lt;-</span> data<span class="sc">$</span>value[data<span class="sc">$</span>condition<span class="sc">==</span><span class="st">"condition1"</span>]</span>
<span id="cb6-2"><a href="#cb6-2"></a>condition2 <span class="ot">&lt;-</span> data<span class="sc">$</span>value[data<span class="sc">$</span>condition<span class="sc">==</span><span class="st">"condition2"</span>]</span>
<span id="cb6-3"><a href="#cb6-3"></a>participant <span class="ot">&lt;-</span> data<span class="sc">$</span>participant[data<span class="sc">$</span>condition<span class="sc">==</span><span class="st">"condition2"</span>]</span>
<span id="cb6-4"><a href="#cb6-4"></a>group <span class="ot">&lt;-</span> data<span class="sc">$</span>group[data<span class="sc">$</span>condition<span class="sc">==</span><span class="st">"condition2"</span>]</span>
<span id="cb6-5"><a href="#cb6-5"></a>rdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(participant,group,condition1,condition2)</span>
<span id="cb6-6"><a href="#cb6-6"></a></span>
<span id="cb6-7"><a href="#cb6-7"></a>scatterdiff <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rdata, <span class="fu">aes</span>(<span class="at">x=</span>condition1, <span class="at">y=</span>condition2, <span class="at">group=</span>group, <span class="at">fill=</span>group, <span class="at">colour=</span>group,<span class="at">shape=</span>group)) <span class="sc">+</span> </span>
<span id="cb6-8"><a href="#cb6-8"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb6-9"><a href="#cb6-9"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">4</span>,<span class="at">stroke=</span><span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb6-10"><a href="#cb6-10"></a>  <span class="fu">theme_linedraw</span>() <span class="sc">+</span></span>
<span id="cb6-11"><a href="#cb6-11"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="dv">22</span>,<span class="dv">21</span>)) <span class="sc">+</span></span>
<span id="cb6-12"><a href="#cb6-12"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"grey70"</span>, <span class="st">"grey95"</span>)) <span class="sc">+</span></span>
<span id="cb6-13"><a href="#cb6-13"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"grey5"</span>,<span class="st">"grey5"</span>)) <span class="sc">+</span></span>
<span id="cb6-14"><a href="#cb6-14"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">position =</span> <span class="st">"inside"</span>)) <span class="sc">+</span></span>
<span id="cb6-15"><a href="#cb6-15"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">"grey20"</span>,<span class="at">size=</span><span class="dv">16</span>),</span>
<span id="cb6-16"><a href="#cb6-16"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">"grey20"</span>,<span class="at">size=</span><span class="dv">16</span>),  </span>
<span id="cb6-17"><a href="#cb6-17"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">"grey20"</span>,<span class="at">size=</span><span class="dv">18</span>),</span>
<span id="cb6-18"><a href="#cb6-18"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">"grey20"</span>,<span class="at">size=</span><span class="dv">18</span>),</span>
<span id="cb6-19"><a href="#cb6-19"></a>        <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="fl">1.5</span>,<span class="st">"cm"</span>),</span>
<span id="cb6-20"><a href="#cb6-20"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">"grey20"</span>,<span class="at">size=</span><span class="dv">16</span>),</span>
<span id="cb6-21"><a href="#cb6-21"></a>        <span class="at">legend.title =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb6-22"><a href="#cb6-22"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">15</span>, .<span class="dv">85</span>),</span>
<span id="cb6-23"><a href="#cb6-23"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">5.5</span>,<span class="fl">5.5</span>,<span class="fl">5.5</span>,<span class="fl">5.5</span>), <span class="st">"pt"</span>),</span>
<span id="cb6-24"><a href="#cb6-24"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">"grey20"</span>,<span class="at">size=</span><span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb6-25"><a href="#cb6-25"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Paired observations"</span>) <span class="sc">+</span></span>
<span id="cb6-26"><a href="#cb6-26"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">16</span>),<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">6</span>,<span class="dv">16</span>,<span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb6-27"><a href="#cb6-27"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">19</span>),<span class="at">breaks=</span><span class="fu">seq</span>(<span class="dv">6</span>,<span class="dv">19</span>,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: A numeric `legend.position` argument in `theme()` was deprecated in ggplot2
3.5.0.
ℹ Please use the `legend.position.inside` argument of `theme()` instead.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>scatterdiff</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="02-08-gar-gpcomp_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="examples-of-standard-group-statistics" class="level2" data-number="7.4"><h2 data-number="7.4" class="anchored" data-anchor-id="examples-of-standard-group-statistics">
<span class="header-section-number">7.4</span> Examples of standard group statistics</h2>
<p>Stats results as reported in the EJN editorial.</p>
<section id="x-2-anova" class="level3" data-number="7.4.1"><h3 data-number="7.4.1" class="anchored" data-anchor-id="x-2-anova">
<span class="header-section-number">7.4.1</span> 2 x 2 ANOVA</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>aov_gp_cond <span class="ot">&lt;-</span> <span class="fu">aov</span>(value <span class="sc">~</span> group<span class="sc">*</span>condition <span class="sc">+</span> <span class="fu">Error</span>(participant<span class="sc">/</span>condition), <span class="at">data=</span>data)</span>
<span id="cb9-2"><a href="#cb9-2"></a></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="fu">summary</span>(aov_gp_cond)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Error: participant
          Df Sum Sq Mean Sq F value Pr(&gt;F)
group      1    4.4    4.43   0.261  0.615
Residuals 20  339.6   16.98               

Error: participant:condition
                Df Sum Sq Mean Sq F value  Pr(&gt;F)   
condition        1  3.986   3.986   7.509 0.01261 * 
group:condition  1  4.430   4.430   8.345 0.00908 **
Residuals       20 10.617   0.531                   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section><section id="group-1-t-test" class="level3" data-number="7.4.2"><h3 data-number="7.4.2" class="anchored" data-anchor-id="group-1-t-test">
<span class="header-section-number">7.4.2</span> Group 1 t-test</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>x <span class="ot">&lt;-</span> data[data<span class="sc">$</span>group<span class="sc">==</span><span class="st">"group1"</span> <span class="sc">&amp;</span> data<span class="sc">$</span>condition<span class="sc">==</span><span class="st">"condition1"</span> ,<span class="st">"value"</span>]</span>
<span id="cb11-2"><a href="#cb11-2"></a>y <span class="ot">&lt;-</span> data[data<span class="sc">$</span>group<span class="sc">==</span><span class="st">"group1"</span> <span class="sc">&amp;</span> data<span class="sc">$</span>condition<span class="sc">==</span><span class="st">"condition2"</span> ,<span class="st">"value"</span>]</span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="fu">t.test</span>(x, y, <span class="at">paired=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  x and y
t = -3.8742, df = 10, p-value = 0.003088
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 -1.9477091 -0.5253818
sample estimates:
mean difference 
      -1.236545 </code></pre>
</div>
</div>
</section><section id="group-2-t-test" class="level3" data-number="7.4.3"><h3 data-number="7.4.3" class="anchored" data-anchor-id="group-2-t-test">
<span class="header-section-number">7.4.3</span> Group 2 t-test</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>x <span class="ot">&lt;-</span> data[data<span class="sc">$</span>group<span class="sc">==</span><span class="st">"group2"</span> <span class="sc">&amp;</span> data<span class="sc">$</span>condition<span class="sc">==</span><span class="st">"condition1"</span> ,<span class="st">"value"</span>]</span>
<span id="cb13-2"><a href="#cb13-2"></a>y <span class="ot">&lt;-</span> data[data<span class="sc">$</span>group<span class="sc">==</span><span class="st">"group2"</span> <span class="sc">&amp;</span> data<span class="sc">$</span>condition<span class="sc">==</span><span class="st">"condition2"</span> ,<span class="st">"value"</span>]</span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="fu">t.test</span>(x,y,<span class="at">paired=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Paired t-test

data:  x and y
t = 0.1081, df = 10, p-value = 0.9161
alternative hypothesis: true mean difference is not equal to 0
95 percent confidence interval:
 -0.6400830  0.7053557
sample estimates:
mean difference 
     0.03263636 </code></pre>
</div>
</div>
</section><section id="make-final-figure-combining-4-panels" class="level3" data-number="7.4.4"><h3 data-number="7.4.4" class="anchored" data-anchor-id="make-final-figure-combining-4-panels">
<span class="header-section-number">7.4.4</span> Make final figure combining 4 panels</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">set.seed</span>(<span class="dv">8</span>)</span>
<span id="cb15-2"><a href="#cb15-2"></a></span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="fu">plot_grid</span>(bargraph, diffstrip, linkedstrip, scatterdiff, </span>
<span id="cb15-4"><a href="#cb15-4"></a>                   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>), </span>
<span id="cb15-5"><a href="#cb15-5"></a>                   <span class="at">ncol =</span> <span class="dv">2</span>, </span>
<span id="cb15-6"><a href="#cb15-6"></a>                   <span class="at">nrow =</span> <span class="dv">2</span>, </span>
<span id="cb15-7"><a href="#cb15-7"></a>                   <span class="at">rel_heights =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb15-8"><a href="#cb15-8"></a>                   <span class="at">label_size =</span> <span class="dv">18</span>,</span>
<span id="cb15-9"><a href="#cb15-9"></a>                   <span class="at">hjust =</span> <span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb15-10"><a href="#cb15-10"></a>                   <span class="at">scale=</span>.<span class="dv">95</span>)</span>
<span id="cb15-11"><a href="#cb15-11"></a></span>
<span id="cb15-12"><a href="#cb15-12"></a><span class="co"># ggsave(filename='./figures/ejn_summary_figure.pdf', units = "cm", width = 30, height = 30)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section><section id="inferences-for-all-pairwise-differences" class="level2" data-number="7.5"><h2 data-number="7.5" class="anchored" data-anchor-id="inferences-for-all-pairwise-differences">
<span class="header-section-number">7.5</span> Inferences for all pairwise differences</h2>
<p>One way to illustrate the 2x2 interaction is to plot the distribution of all pairwise differences, between the two independent groups, of the condition differences. Indeed, an interaction is a difference of differences.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>g1diff <span class="ot">&lt;-</span> data[data<span class="sc">$</span>group<span class="sc">==</span><span class="st">"group1"</span> <span class="sc">&amp;</span> data<span class="sc">$</span>condition<span class="sc">==</span><span class="st">"condition2"</span> ,<span class="st">"value"</span>] <span class="sc">-</span> data[data<span class="sc">$</span>group<span class="sc">==</span><span class="st">"group1"</span> <span class="sc">&amp;</span> data<span class="sc">$</span>condition<span class="sc">==</span><span class="st">"condition1"</span> ,<span class="st">"value"</span>]</span>
<span id="cb16-2"><a href="#cb16-2"></a></span>
<span id="cb16-3"><a href="#cb16-3"></a>g2diff <span class="ot">&lt;-</span> data[data<span class="sc">$</span>group<span class="sc">==</span><span class="st">"group2"</span> <span class="sc">&amp;</span> data<span class="sc">$</span>condition<span class="sc">==</span><span class="st">"condition2"</span> ,<span class="st">"value"</span>] <span class="sc">-</span> data[data<span class="sc">$</span>group<span class="sc">==</span><span class="st">"group2"</span> <span class="sc">&amp;</span> data<span class="sc">$</span>condition<span class="sc">==</span><span class="st">"condition1"</span> ,<span class="st">"value"</span>]</span>
<span id="cb16-4"><a href="#cb16-4"></a></span>
<span id="cb16-5"><a href="#cb16-5"></a>apd <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">outer</span>(g1diff, g2diff, <span class="at">FUN=</span><span class="st">"-"</span>)) <span class="co"># all pairwise differences</span></span>
<span id="cb16-6"><a href="#cb16-6"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x =</span> apd)</span>
<span id="cb16-7"><a href="#cb16-7"></a></span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span> </span>
<span id="cb16-9"><a href="#cb16-9"></a>  theme_gar <span class="sc">+</span></span>
<span id="cb16-10"><a href="#cb16-10"></a>  <span class="fu">geom_density</span>(<span class="at">alpha =</span> <span class="dv">1</span> , <span class="at">fill =</span> <span class="st">"grey95"</span>, <span class="at">colour =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb16-11"><a href="#cb16-11"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span> <span class="co"># zero reference line</span></span>
<span id="cb16-12"><a href="#cb16-12"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">median</span>(apd)) <span class="sc">+</span> <span class="co"># median difference</span></span>
<span id="cb16-13"><a href="#cb16-13"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>,</span>
<span id="cb16-14"><a href="#cb16-14"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>),</span>
<span id="cb16-15"><a href="#cb16-15"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>,<span class="at">face=</span><span class="st">"bold"</span>),</span>
<span id="cb16-16"><a href="#cb16-16"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb16-17"><a href="#cb16-17"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb16-18"><a href="#cb16-18"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">6</span>)) <span class="sc">+</span></span>
<span id="cb16-19"><a href="#cb16-19"></a>  <span class="fu">ylab</span>(<span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb16-20"><a href="#cb16-20"></a>  <span class="fu">xlab</span>(<span class="st">"All pairwise differences of condition 2 minus condition 1"</span>) <span class="sc">+</span></span>
<span id="cb16-21"><a href="#cb16-21"></a>  <span class="fu">ggtitle</span>(<span class="fu">paste0</span>(<span class="st">"Median = "</span>, <span class="fu">median</span>(apd), <span class="st">", P(X&gt;Y) = "</span>, <span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span><span class="fu">mean</span>(apd<span class="sc">&gt;</span><span class="dv">0</span>), <span class="at">digits=</span><span class="dv">1</span>), <span class="st">"%"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="02-08-gar-gpcomp_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="more-details-about-inferences-on-all-pairwise-differences" class="level3" data-number="7.5.1"><h3 data-number="7.5.1" class="anchored" data-anchor-id="more-details-about-inferences-on-all-pairwise-differences">
<span class="header-section-number">7.5.1</span> More details about inferences on all pairwise differences</h3>
<section id="compute" class="level4" data-number="7.5.1.1"><h4 data-number="7.5.1.1" class="anchored" data-anchor-id="compute">
<span class="header-section-number">7.5.1.1</span> Compute</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>apd <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(<span class="fu">outer</span>(g1diff, g2diff, <span class="at">FUN=</span><span class="st">"-"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="all-pairwise-differences-implementation" class="level4" data-number="7.5.1.2"><h4 data-number="7.5.1.2" class="anchored" data-anchor-id="all-pairwise-differences-implementation">
<span class="header-section-number">7.5.1.2</span> All pairwise differences: implementation</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>y <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="fu">outer</span>(x, y, <span class="at">FUN=</span><span class="st">"-"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4] [,5]
[1,]    0   -1   -2   -3   -4
[2,]    1    0   -1   -2   -3
[3,]    2    1    0   -1   -2
[4,]    3    2    1    0   -1
[5,]    4    3    2    1    0</code></pre>
</div>
</div>
</section><section id="median-of-all-pairwise-differences" class="level4" data-number="7.5.1.3"><h4 data-number="7.5.1.3" class="anchored" data-anchor-id="median-of-all-pairwise-differences">
<span class="header-section-number">7.5.1.3</span> Median of all pairwise differences</h4>
<p>For a measure of effect size preserving the original units, we could report the median of all pairwise differences and its percentile bootstrap confidence interval:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>out <span class="ot">&lt;-</span> <span class="fu">wmwpb</span>(g1diff, g2diff, <span class="at">est=</span>median, <span class="at">alpha=</span>.<span class="dv">05</span>, <span class="at">nboot=</span><span class="dv">2000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Median of all pairwise differences = 1.2 [0.347, 2.092], <em>P</em>=0.003.</p>
<p>This measure answer the questions: what is the typical difference between two observations selected at random from the two groups?</p>
</section><section id="plot-bootstrap-distribution" class="level4" data-number="7.5.1.4"><h4 data-number="7.5.1.4" class="anchored" data-anchor-id="plot-bootstrap-distribution">
<span class="header-section-number">7.5.1.4</span> Plot bootstrap distribution</h4>
<p>Here we calculate and plot the bootstrap distribution of the medians of all pairwise differences between the two independent groups. The results should be very similar to the ones from the <code>wmwpb</code> function we used in the previous chunk.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb21-2"><a href="#cb21-2"></a>nboot <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb21-3"><a href="#cb21-3"></a>aav <span class="ot">&lt;-</span> <span class="fl">0.05</span> <span class="co"># arbitrary alpha value</span></span>
<span id="cb21-4"><a href="#cb21-4"></a>n1 <span class="ot">&lt;-</span> <span class="fu">length</span>(g1diff)</span>
<span id="cb21-5"><a href="#cb21-5"></a>n2 <span class="ot">&lt;-</span> <span class="fu">length</span>(g2diff)</span>
<span id="cb21-6"><a href="#cb21-6"></a></span>
<span id="cb21-7"><a href="#cb21-7"></a><span class="co"># bootstrap sampling independently from each group</span></span>
<span id="cb21-8"><a href="#cb21-8"></a>boot.diff <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"numeric"</span>, <span class="at">length =</span> nboot)</span>
<span id="cb21-9"><a href="#cb21-9"></a><span class="cf">for</span>(B <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nboot){</span>
<span id="cb21-10"><a href="#cb21-10"></a>  boot.diff[B] <span class="ot">&lt;-</span> <span class="fu">median</span>(<span class="fu">outer</span>(<span class="fu">sample</span>(g1diff, <span class="at">size=</span>n1, <span class="at">replace=</span><span class="cn">TRUE</span>),<span class="fu">sample</span>(g2diff, <span class="at">size=</span>n2, <span class="at">replace=</span><span class="cn">TRUE</span>),<span class="at">FUN=</span><span class="st">"-"</span>))  </span>
<span id="cb21-11"><a href="#cb21-11"></a>}</span>
<span id="cb21-12"><a href="#cb21-12"></a></span>
<span id="cb21-13"><a href="#cb21-13"></a>ci <span class="ot">&lt;-</span> <span class="fu">quantile</span>(boot.diff, <span class="at">probs =</span> <span class="fu">c</span>(aav<span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">-</span>aav<span class="sc">/</span><span class="dv">2</span>)) </span>
<span id="cb21-14"><a href="#cb21-14"></a></span>
<span id="cb21-15"><a href="#cb21-15"></a>df <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">with</span>(<span class="fu">density</span>(boot.diff),<span class="fu">data.frame</span>(x,y)))</span>
<span id="cb21-16"><a href="#cb21-16"></a></span>
<span id="cb21-17"><a href="#cb21-17"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span> theme_gar <span class="sc">+</span></span>
<span id="cb21-18"><a href="#cb21-18"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">median</span>(apd), <span class="at">colour =</span> <span class="st">"grey"</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb21-19"><a href="#cb21-19"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb21-20"><a href="#cb21-20"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Bootstrap medians of all pairwise differences"</span>, <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb21-21"><a href="#cb21-21"></a>    <span class="co"># confidence interval ----------------------</span></span>
<span id="cb21-22"><a href="#cb21-22"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> ci[<span class="dv">1</span>], <span class="at">xend =</span> ci[<span class="dv">2</span>],</span>
<span id="cb21-23"><a href="#cb21-23"></a>               <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> <span class="dv">0</span>,</span>
<span id="cb21-24"><a href="#cb21-24"></a>               <span class="at">lineend =</span> <span class="st">"round"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">colour =</span> <span class="st">"orange"</span>) <span class="sc">+</span></span>
<span id="cb21-25"><a href="#cb21-25"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"label"</span>, <span class="at">x =</span> ci[<span class="dv">1</span>]<span class="sc">+</span><span class="fl">0.15</span>, <span class="at">y =</span> <span class="fl">0.1</span><span class="sc">*</span><span class="fu">max</span>(df<span class="sc">$</span>y), <span class="at">size =</span> <span class="dv">7</span>,</span>
<span id="cb21-26"><a href="#cb21-26"></a>             <span class="at">colour =</span> <span class="st">"white"</span>, <span class="at">fill =</span> <span class="st">"orange"</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>,</span>
<span id="cb21-27"><a href="#cb21-27"></a>             <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"L = "</span>, <span class="fu">round</span>(ci[<span class="dv">1</span>], <span class="at">digits =</span> <span class="dv">2</span>))) <span class="sc">+</span></span>
<span id="cb21-28"><a href="#cb21-28"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"label"</span>, <span class="at">x =</span> ci[<span class="dv">2</span>]<span class="sc">-</span><span class="fl">0.15</span>, <span class="at">y =</span> <span class="fl">0.1</span><span class="sc">*</span><span class="fu">max</span>(df<span class="sc">$</span>y), <span class="at">size =</span> <span class="dv">7</span>,</span>
<span id="cb21-29"><a href="#cb21-29"></a>             <span class="at">colour =</span> <span class="st">"white"</span>, <span class="at">fill =</span> <span class="st">"orange"</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>,</span>
<span id="cb21-30"><a href="#cb21-30"></a>             <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"U = "</span>, <span class="fu">round</span>(ci[<span class="dv">2</span>], <span class="at">digits =</span> <span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="02-08-gar-gpcomp_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># ggsave(filename=('./figures/nbx_fig_2gpsbootres.pdf'),width=7,height=5)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="pxy" class="level4" data-number="7.5.1.5"><h4 data-number="7.5.1.5" class="anchored" data-anchor-id="pxy">
<span class="header-section-number">7.5.1.5</span> <span class="math inline">\(P(X&gt;Y)\)</span>
</h4>
<p>Given two observations selected at random from these two groups, what is the probability that an observation from group 1 will be larger than one in group 2?</p>
<p>Using the <code>cid()</code> function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>out <span class="ot">&lt;-</span> <span class="fu">cid</span>(g1diff, g2diff)</span>
<span id="cb24-2"><a href="#cb24-2"></a>out<span class="sc">$</span>summary.dvals[<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8181818</code></pre>
</div>
</div>
<p><code>cid()</code> also returns the complementary probability <span class="math inline">\(P(X&lt;Y)\)</span> and the robust ordinal measure of effect size known as Cliff’s delta: <span class="math inline">\(d = P(X&gt;Y) - P(X&lt;Y)\)</span>.</p>
<p>Make our own function to compute the probability that X is greater than Y:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>pxgy <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y){</span>
<span id="cb26-2"><a href="#cb26-2"></a>  <span class="fu">mean</span>(<span class="fu">outer</span>(x,y,<span class="at">FUN=</span><span class="st">"-"</span>) <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb26-3"><a href="#cb26-3"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Use it:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="fu">pxgy</span>(g1diff, g2diff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8181818</code></pre>
</div>
</div>
</section><section id="confidence-interval" class="level4" data-number="7.5.1.6"><h4 data-number="7.5.1.6" class="anchored" data-anchor-id="confidence-interval">
<span class="header-section-number">7.5.1.6</span> Confidence interval</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="fu">set.seed</span>(<span class="dv">21</span>)</span>
<span id="cb29-2"><a href="#cb29-2"></a></span>
<span id="cb29-3"><a href="#cb29-3"></a>nboot <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb29-4"><a href="#cb29-4"></a>b.res <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode =</span> <span class="st">"numeric"</span>, <span class="at">length =</span> nboot)</span>
<span id="cb29-5"><a href="#cb29-5"></a><span class="cf">for</span>(B <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nboot){</span>
<span id="cb29-6"><a href="#cb29-6"></a>  b.res[B] <span class="ot">&lt;-</span> <span class="fu">pxgy</span>(<span class="fu">sample</span>(g1diff, n1, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb29-7"><a href="#cb29-7"></a>                   <span class="fu">sample</span>(g2diff, n2, <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb29-8"><a href="#cb29-8"></a>}</span>
<span id="cb29-9"><a href="#cb29-9"></a></span>
<span id="cb29-10"><a href="#cb29-10"></a><span class="fu">quantile</span>(b.res, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     2.5%     97.5% 
0.6198347 0.9752066 </code></pre>
</div>
</div>
</section><section id="plot-bootstrap-distribution-1" class="level4" data-number="7.5.1.7"><h4 data-number="7.5.1.7" class="anchored" data-anchor-id="plot-bootstrap-distribution-1">
<span class="header-section-number">7.5.1.7</span> Plot bootstrap distribution</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>diff <span class="ot">&lt;-</span> <span class="fu">pxgy</span>(g1diff, g2diff) <span class="co"># group difference</span></span>
<span id="cb31-2"><a href="#cb31-2"></a>ci <span class="ot">&lt;-</span> <span class="fu">quantile</span>(b.res, <span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span>
<span id="cb31-3"><a href="#cb31-3"></a>ci1 <span class="ot">&lt;-</span> ci[<span class="dv">1</span>]</span>
<span id="cb31-4"><a href="#cb31-4"></a>ci2 <span class="ot">&lt;-</span> ci[<span class="dv">2</span>]</span>
<span id="cb31-5"><a href="#cb31-5"></a></span>
<span id="cb31-6"><a href="#cb31-6"></a>df <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">with</span>(<span class="fu">density</span>(b.res, <span class="at">to =</span> <span class="dv">1</span>),<span class="fu">data.frame</span>(x,y)))</span>
<span id="cb31-7"><a href="#cb31-7"></a><span class="co"># in the lecture, the graph I presented was generated by using this line of code:</span></span>
<span id="cb31-8"><a href="#cb31-8"></a><span class="co"># df &lt;- as_tibble(with(density(b.res),data.frame(x,y)))</span></span>
<span id="cb31-9"><a href="#cb31-9"></a><span class="co"># How do the graphs differ?</span></span>
<span id="cb31-10"><a href="#cb31-10"></a><span class="co"># check the help for the density function.</span></span>
<span id="cb31-11"><a href="#cb31-11"></a></span>
<span id="cb31-12"><a href="#cb31-12"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span> theme_gar <span class="sc">+</span></span>
<span id="cb31-13"><a href="#cb31-13"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> diff, <span class="at">colour =</span> <span class="st">"grey"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb31-14"><a href="#cb31-14"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb31-15"><a href="#cb31-15"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>)) <span class="sc">+</span></span>
<span id="cb31-16"><a href="#cb31-16"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">1.05</span>)) <span class="sc">+</span></span>
<span id="cb31-17"><a href="#cb31-17"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Bootstrap P(X&gt;Y)"</span>, <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb31-18"><a href="#cb31-18"></a>    <span class="co"># confidence interval ----------------------</span></span>
<span id="cb31-19"><a href="#cb31-19"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> ci[<span class="dv">1</span>], <span class="at">xend =</span> ci[<span class="dv">2</span>],</span>
<span id="cb31-20"><a href="#cb31-20"></a>               <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> <span class="dv">0</span>,</span>
<span id="cb31-21"><a href="#cb31-21"></a>               <span class="at">lineend =</span> <span class="st">"round"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">colour =</span> <span class="st">"orange"</span>) <span class="sc">+</span></span>
<span id="cb31-22"><a href="#cb31-22"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"label"</span>, <span class="at">x =</span> ci1<span class="fl">+0.015</span>, <span class="at">y =</span> <span class="fl">0.1</span><span class="sc">*</span><span class="fu">max</span>(df<span class="sc">$</span>y), <span class="at">size =</span> <span class="dv">7</span>,</span>
<span id="cb31-23"><a href="#cb31-23"></a>             <span class="at">colour =</span> <span class="st">"white"</span>, <span class="at">fill =</span> <span class="st">"orange"</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>,</span>
<span id="cb31-24"><a href="#cb31-24"></a>             <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"L = "</span>, <span class="fu">round</span>(ci1, <span class="at">digits =</span> <span class="dv">2</span>))) <span class="sc">+</span></span>
<span id="cb31-25"><a href="#cb31-25"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"label"</span>, <span class="at">x =</span> ci2<span class="fl">-0.015</span>, <span class="at">y =</span> <span class="fl">0.1</span><span class="sc">*</span><span class="fu">max</span>(df<span class="sc">$</span>y), <span class="at">size =</span> <span class="dv">7</span>,</span>
<span id="cb31-26"><a href="#cb31-26"></a>             <span class="at">colour =</span> <span class="st">"white"</span>, <span class="at">fill =</span> <span class="st">"orange"</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>,</span>
<span id="cb31-27"><a href="#cb31-27"></a>             <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"U = "</span>, <span class="fu">round</span>(ci2, <span class="at">digits =</span> <span class="dv">2</span>))) <span class="sc">+</span></span>
<span id="cb31-28"><a href="#cb31-28"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb31-29"><a href="#cb31-29"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="02-08-gar-gpcomp_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section></section><section id="two-dependent-groups-learning-experiment" class="level2" data-number="7.6"><h2 data-number="7.6" class="anchored" data-anchor-id="two-dependent-groups-learning-experiment">
<span class="header-section-number">7.6</span> Two dependent groups: learning experiment</h2>
<p>Here are two vectors of paired scores from a cognitive test in two sessions. We are interested in learning effects between sessions.</p>
<section id="simulate-data-from-n-participants" class="level3" data-number="7.6.1"><h3 data-number="7.6.1" class="anchored" data-anchor-id="simulate-data-from-n-participants">
<span class="header-section-number">7.6.1</span> Simulate data from n participants</h3>
<p>We use the <code>faux</code> package from Lisa Debruine to do that.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="fu">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb32-2"><a href="#cb32-2"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span> <span class="co"># number of participants</span></span>
<span id="cb32-3"><a href="#cb32-3"></a></span>
<span id="cb32-4"><a href="#cb32-4"></a>df1 <span class="ot">&lt;-</span> <span class="fu">rmulti</span>(<span class="at">n =</span> n, </span>
<span id="cb32-5"><a href="#cb32-5"></a>              <span class="at">dist =</span> <span class="fu">c</span>(<span class="at">session1 =</span> <span class="st">"beta"</span>,</span>
<span id="cb32-6"><a href="#cb32-6"></a>                       <span class="at">session2 =</span> <span class="st">"beta"</span>),</span>
<span id="cb32-7"><a href="#cb32-7"></a>              <span class="at">params =</span> <span class="fu">list</span>(<span class="at">session1 =</span> <span class="fu">c</span>(<span class="at">shape1=</span><span class="dv">3</span>, <span class="at">shape2=</span><span class="dv">1</span>),</span>
<span id="cb32-8"><a href="#cb32-8"></a>                            <span class="at">session2 =</span> <span class="fu">c</span>(<span class="at">shape1=</span><span class="dv">5</span>, <span class="at">shape2=</span><span class="dv">1</span>)),</span>
<span id="cb32-9"><a href="#cb32-9"></a>              <span class="at">r =</span> <span class="fl">0.7</span>)</span>
<span id="cb32-10"><a href="#cb32-10"></a></span>
<span id="cb32-11"><a href="#cb32-11"></a><span class="fu">ggplot</span>(df1, <span class="fu">aes</span>(<span class="at">x=</span>session1,<span class="at">y=</span>session2)) <span class="sc">+</span> theme_gar <span class="sc">+</span></span>
<span id="cb32-12"><a href="#cb32-12"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb32-13"><a href="#cb32-13"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb32-14"><a href="#cb32-14"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb32-15"><a href="#cb32-15"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="02-08-gar-gpcomp_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="illustrate-results" class="level3" data-number="7.6.2"><h3 data-number="7.6.2" class="anchored" data-anchor-id="illustrate-results">
<span class="header-section-number">7.6.2</span> Illustrate results</h3>
<section id="make-data-frame" class="level4" data-number="7.6.2.1"><h4 data-number="7.6.2.1" class="anchored" data-anchor-id="make-data-frame">
<span class="header-section-number">7.6.2.1</span> Make data frame</h4>
<p>Reformat data frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">participant =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="dv">2</span>),</span>
<span id="cb34-2"><a href="#cb34-2"></a>              <span class="at">score =</span> <span class="fu">c</span>(df1<span class="sc">$</span>session1, df1<span class="sc">$</span>session2),</span>
<span id="cb34-3"><a href="#cb34-3"></a>              <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Session 1"</span>, <span class="st">"Session 2"</span>), <span class="at">each =</span> n)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="independent-stripcharts-1d-scatterplots" class="level4" data-number="7.6.2.2"><h4 data-number="7.6.2.2" class="anchored" data-anchor-id="independent-stripcharts-1d-scatterplots">
<span class="header-section-number">7.6.2.2</span> Independent stripcharts (1D scatterplots)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="fu">set.seed</span>(<span class="dv">44</span>) <span class="co"># reproducible jitter</span></span>
<span id="cb35-2"><a href="#cb35-2"></a></span>
<span id="cb35-3"><a href="#cb35-3"></a><span class="fu">ggplot</span>(df2, <span class="fu">aes</span>(<span class="at">x =</span> group,</span>
<span id="cb35-4"><a href="#cb35-4"></a>               <span class="at">y =</span> score,</span>
<span id="cb35-5"><a href="#cb35-5"></a>               <span class="at">fill =</span> group)) <span class="sc">+</span></span>
<span id="cb35-6"><a href="#cb35-6"></a><span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb35-7"><a href="#cb35-7"></a>            <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb35-8"><a href="#cb35-8"></a>            <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb35-9"><a href="#cb35-9"></a>            <span class="at">width =</span> .<span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb35-10"><a href="#cb35-10"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>)) <span class="sc">+</span></span>
<span id="cb35-11"><a href="#cb35-11"></a>    <span class="fu">theme_linedraw</span>() <span class="sc">+</span></span>
<span id="cb35-12"><a href="#cb35-12"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb35-13"><a href="#cb35-13"></a>    <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>,<span class="at">face=</span><span class="st">"bold"</span>),</span>
<span id="cb35-14"><a href="#cb35-14"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb35-15"><a href="#cb35-15"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>)) <span class="sc">+</span></span>
<span id="cb35-16"><a href="#cb35-16"></a>    <span class="fu">ylab</span>(<span class="st">"Score"</span>) <span class="sc">+</span></span>
<span id="cb35-17"><a href="#cb35-17"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="02-08-gar-gpcomp_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="stripcharts-with-medians" class="level4" data-number="7.6.2.3"><h4 data-number="7.6.2.3" class="anchored" data-anchor-id="stripcharts-with-medians">
<span class="header-section-number">7.6.2.3</span> Stripcharts with medians</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="fu">set.seed</span>(<span class="dv">44</span>) <span class="co"># reproducible jitter</span></span>
<span id="cb36-2"><a href="#cb36-2"></a></span>
<span id="cb36-3"><a href="#cb36-3"></a><span class="co"># compute medians</span></span>
<span id="cb36-4"><a href="#cb36-4"></a>md1 <span class="ot">&lt;-</span> <span class="fu">median</span>(df1<span class="sc">$</span>session1)</span>
<span id="cb36-5"><a href="#cb36-5"></a>md2 <span class="ot">&lt;-</span> <span class="fu">median</span>(df1<span class="sc">$</span>session2)</span>
<span id="cb36-6"><a href="#cb36-6"></a></span>
<span id="cb36-7"><a href="#cb36-7"></a><span class="fu">ggplot</span>(df2, <span class="fu">aes</span>(<span class="at">x =</span> group,</span>
<span id="cb36-8"><a href="#cb36-8"></a>               <span class="at">y =</span> score,</span>
<span id="cb36-9"><a href="#cb36-9"></a>               <span class="at">fill =</span> group)) <span class="sc">+</span></span>
<span id="cb36-10"><a href="#cb36-10"></a><span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb36-11"><a href="#cb36-11"></a>            <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb36-12"><a href="#cb36-12"></a>            <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb36-13"><a href="#cb36-13"></a>            <span class="at">width =</span> .<span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb36-14"><a href="#cb36-14"></a><span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>)) <span class="sc">+</span></span>
<span id="cb36-15"><a href="#cb36-15"></a>  <span class="fu">theme_linedraw</span>() <span class="sc">+</span> </span>
<span id="cb36-16"><a href="#cb36-16"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb36-17"><a href="#cb36-17"></a>  <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>,<span class="at">face=</span><span class="st">"bold"</span>),</span>
<span id="cb36-18"><a href="#cb36-18"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb36-19"><a href="#cb36-19"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>)) <span class="sc">+</span></span>
<span id="cb36-20"><a href="#cb36-20"></a>        <span class="fu">ylab</span>(<span class="st">"Scores"</span>) <span class="sc">+</span></span>
<span id="cb36-21"><a href="#cb36-21"></a><span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb36-22"><a href="#cb36-22"></a><span class="co"># add median for session 1</span></span>
<span id="cb36-23"><a href="#cb36-23"></a><span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">0.75</span>, <span class="at">y =</span> md1, <span class="at">xend =</span> <span class="fl">1.25</span>, <span class="at">yend =</span> md1), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb36-24"><a href="#cb36-24"></a><span class="co"># add median for session 2</span></span>
<span id="cb36-25"><a href="#cb36-25"></a><span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fl">1.75</span>, <span class="at">y =</span> md2, <span class="at">xend =</span> <span class="fl">2.25</span>, <span class="at">yend =</span> md2), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="02-08-gar-gpcomp_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="linked-stripcharts" class="level4" data-number="7.6.2.4"><h4 data-number="7.6.2.4" class="anchored" data-anchor-id="linked-stripcharts">
<span class="header-section-number">7.6.2.4</span> Linked stripcharts</h4>
<p>New illustration in which coloured lines link paired observations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="fu">set.seed</span>(<span class="dv">44</span>) <span class="co"># reproducible jitter</span></span>
<span id="cb37-2"><a href="#cb37-2"></a></span>
<span id="cb37-3"><a href="#cb37-3"></a>pd <span class="ot">&lt;-</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.1</span>)</span>
<span id="cb37-4"><a href="#cb37-4"></a></span>
<span id="cb37-5"><a href="#cb37-5"></a><span class="fu">ggplot</span>(df2, <span class="fu">aes</span>(<span class="at">x=</span>group, <span class="at">y=</span>score, <span class="at">group=</span>participant)) <span class="sc">+</span> <span class="fu">theme_linedraw</span>() <span class="sc">+</span></span>
<span id="cb37-6"><a href="#cb37-6"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">colour=</span>participant),<span class="at">size=</span><span class="dv">1</span>, <span class="at">alpha=</span>.<span class="dv">9</span>,</span>
<span id="cb37-7"><a href="#cb37-7"></a>            <span class="at">position=</span>pd) <span class="sc">+</span></span>
<span id="cb37-8"><a href="#cb37-8"></a>  <span class="fu">scale_colour_viridis_c</span>(<span class="at">option =</span> <span class="st">"A"</span>) <span class="sc">+</span></span>
<span id="cb37-9"><a href="#cb37-9"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>),</span>
<span id="cb37-10"><a href="#cb37-10"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb37-11"><a href="#cb37-11"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>,<span class="at">face=</span><span class="st">"bold"</span>),</span>
<span id="cb37-12"><a href="#cb37-12"></a>        <span class="at">legend.position=</span><span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb37-13"><a href="#cb37-13"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb37-14"><a href="#cb37-14"></a>  <span class="fu">ylab</span>(<span class="st">"Scores"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="02-08-gar-gpcomp_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="d-scatterplot-stripchart-of-differences" class="level3" data-number="7.6.3"><h3 data-number="7.6.3" class="anchored" data-anchor-id="d-scatterplot-stripchart-of-differences">
<span class="header-section-number">7.6.3</span> 1D scatterplot = stripchart of differences</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="fu">set.seed</span>(<span class="dv">44</span>) <span class="co"># reproducible jitter</span></span>
<span id="cb38-2"><a href="#cb38-2"></a></span>
<span id="cb38-3"><a href="#cb38-3"></a>df.diff <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">participant =</span> <span class="dv">1</span><span class="sc">:</span>n,</span>
<span id="cb38-4"><a href="#cb38-4"></a>                  <span class="at">difference =</span> df1<span class="sc">$</span>session2 <span class="sc">-</span> df1<span class="sc">$</span>session1,</span>
<span id="cb38-5"><a href="#cb38-5"></a>                  <span class="at">gr =</span> <span class="fu">rep</span>(<span class="st">"gr"</span>, n))</span>
<span id="cb38-6"><a href="#cb38-6"></a></span>
<span id="cb38-7"><a href="#cb38-7"></a><span class="fu">ggplot</span>(df.diff, <span class="fu">aes</span>(<span class="at">x=</span>gr, <span class="at">y=</span>difference)) <span class="sc">+</span> theme_gar <span class="sc">+</span></span>
<span id="cb38-8"><a href="#cb38-8"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="dv">2</span>) <span class="sc">+</span> <span class="co"># zero reference line</span></span>
<span id="cb38-9"><a href="#cb38-9"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb38-10"><a href="#cb38-10"></a>              <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb38-11"><a href="#cb38-11"></a>              <span class="at">size =</span> <span class="dv">2</span>,</span>
<span id="cb38-12"><a href="#cb38-12"></a>              <span class="at">width =</span> .<span class="dv">15</span>,</span>
<span id="cb38-13"><a href="#cb38-13"></a>              <span class="at">colour =</span> <span class="st">"grey10"</span>,</span>
<span id="cb38-14"><a href="#cb38-14"></a>              <span class="at">fill =</span> <span class="st">"grey90"</span>) <span class="sc">+</span></span>
<span id="cb38-15"><a href="#cb38-15"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"none"</span>,</span>
<span id="cb38-16"><a href="#cb38-16"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_line</span>(<span class="at">colour=</span><span class="st">"white"</span>),</span>
<span id="cb38-17"><a href="#cb38-17"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>,<span class="at">colour=</span><span class="st">"white"</span>),</span>
<span id="cb38-18"><a href="#cb38-18"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>),</span>
<span id="cb38-19"><a href="#cb38-19"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>,<span class="at">face=</span><span class="st">"bold"</span>,<span class="at">colour=</span><span class="st">"white"</span>),</span>
<span id="cb38-20"><a href="#cb38-20"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>,<span class="at">face=</span><span class="st">"bold"</span>),</span>
<span id="cb38-21"><a href="#cb38-21"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">colour=</span><span class="st">"black"</span>,<span class="at">size=</span><span class="dv">20</span>),</span>
<span id="cb38-22"><a href="#cb38-22"></a>        <span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb38-23"><a href="#cb38-23"></a>        <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb38-24"><a href="#cb38-24"></a>  <span class="fu">ylab</span>(<span class="st">"Differences"</span>) <span class="sc">+</span></span>
<span id="cb38-25"><a href="#cb38-25"></a>  <span class="co"># scale_y_continuous(limits=c(-0.6, 0.6), breaks=seq(-0.6, 0.6, 0.1)) +</span></span>
<span id="cb38-26"><a href="#cb38-26"></a>   <span class="fu">stat_summary</span>(<span class="at">fun =</span> median, <span class="at">fun.min =</span> median, <span class="at">fun.max =</span> median,</span>
<span id="cb38-27"><a href="#cb38-27"></a>                 <span class="at">geom =</span> <span class="st">"crossbar"</span>, <span class="at">width =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="02-08-gar-gpcomp_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="144"></p>
</figure>
</div>
</div>
</div>
<section id="scatterplot-of-paired-observations-1" class="level4" data-number="7.6.3.1"><h4 data-number="7.6.3.1" class="anchored" data-anchor-id="scatterplot-of-paired-observations-1">
<span class="header-section-number">7.6.3.1</span> Scatterplot of paired observations</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="fu">ggplot</span>(df1, <span class="fu">aes</span>(<span class="at">x =</span> session1, <span class="at">y =</span> session2)) <span class="sc">+</span> <span class="fu">theme_linedraw</span>() <span class="sc">+</span></span>
<span id="cb39-2"><a href="#cb39-2"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb39-3"><a href="#cb39-3"></a>              <span class="at">shape =</span> <span class="dv">21</span>,</span>
<span id="cb39-4"><a href="#cb39-4"></a>              <span class="at">size =</span> <span class="dv">4</span>,</span>
<span id="cb39-5"><a href="#cb39-5"></a>              <span class="at">colour =</span> <span class="st">"grey10"</span>,</span>
<span id="cb39-6"><a href="#cb39-6"></a>              <span class="at">fill =</span> <span class="st">"grey90"</span>) <span class="sc">+</span></span>
<span id="cb39-7"><a href="#cb39-7"></a>  <span class="fu">geom_smooth</span>() <span class="sc">+</span></span>
<span id="cb39-8"><a href="#cb39-8"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>,</span>
<span id="cb39-9"><a href="#cb39-9"></a>              <span class="at">slope =</span> <span class="dv">1</span>,</span>
<span id="cb39-10"><a href="#cb39-10"></a>              <span class="at">linetype =</span> <span class="st">"longdash"</span>) <span class="sc">+</span> <span class="co"># slope 1 reference line</span></span>
<span id="cb39-11"><a href="#cb39-11"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">16</span>,<span class="at">face=</span><span class="st">"bold"</span>),</span>
<span id="cb39-12"><a href="#cb39-12"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>)) <span class="sc">+</span></span>
<span id="cb39-13"><a href="#cb39-13"></a>  <span class="fu">xlab</span>(<span class="st">"Session 1"</span>) <span class="sc">+</span></span>
<span id="cb39-14"><a href="#cb39-14"></a>  <span class="fu">ylab</span>(<span class="st">"Session 2"</span>) <span class="sc">+</span></span>
<span id="cb39-15"><a href="#cb39-15"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, .<span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb39-16"><a href="#cb39-16"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb39-17"><a href="#cb39-17"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="02-08-gar-gpcomp_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section></section><section id="compare-marginals" class="level2" data-number="7.7"><h2 data-number="7.7" class="anchored" data-anchor-id="compare-marginals">
<span class="header-section-number">7.7</span> Compare marginals</h2>
<p>Treated (wrongly) as two independent groups, is the typical score in session 2 higher than in session 1?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="co"># percentile bootstrap confidence interval of the difference between</span></span>
<span id="cb41-2"><a href="#cb41-2"></a><span class="co"># medians, treating the groups as independent</span></span>
<span id="cb41-3"><a href="#cb41-3"></a><span class="fu">pb2gen</span>(df1<span class="sc">$</span>session2, df1<span class="sc">$</span>session1, <span class="at">alpha=</span>.<span class="dv">05</span>, <span class="at">nboot=</span><span class="dv">2000</span>, <span class="at">est=</span>median)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$est.1
[1] 0.8765588

$est.2
[1] 0.7925541

$est.dif
[1] 0.08400476

$ci
[1] 0.03999068 0.13358857

$p.value
[1] 0.001

$sq.se
[1] 0.000605188

$n1
[1] 100

$n2
[1] 100</code></pre>
</div>
</div>
</section><section id="quantify-within-participant-differences" class="level2" data-number="7.8"><h2 data-number="7.8" class="anchored" data-anchor-id="quantify-within-participant-differences">
<span class="header-section-number">7.8</span> Quantify within participant differences</h2>
<p>Can we conclude that, within participants, scores are higher in session 2 relative to session 1?</p>
<section id="summary-statistics" class="level3" data-number="7.8.1"><h3 data-number="7.8.1" class="anchored" data-anchor-id="summary-statistics">
<span class="header-section-number">7.8.1</span> Summary statistics</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="fu">summary</span>(df1<span class="sc">$</span>session2 <span class="sc">-</span> df1<span class="sc">$</span>session1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
-0.249530 -0.004875  0.077910  0.094901  0.176995  0.465837 </code></pre>
</div>
</div>
</section><section id="bootstrap-test" class="level3" data-number="7.8.2"><h3 data-number="7.8.2" class="anchored" data-anchor-id="bootstrap-test">
<span class="header-section-number">7.8.2</span> Bootstrap test</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="co"># Compute confidence interval of the median of the paired differences</span></span>
<span id="cb45-2"><a href="#cb45-2"></a><span class="fu">onesampb</span>(df1<span class="sc">$</span>session2 <span class="sc">-</span> df1<span class="sc">$</span>session1, <span class="at">alpha=</span>.<span class="dv">05</span>, <span class="at">nboot=</span><span class="dv">2000</span>, <span class="at">est=</span>median)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$ci
[1] 0.04740512 0.10957389

$n
[1] 100

$estimate
[1] 0.07790945

$p.value
[1] 0</code></pre>
</div>
</div>
<section id="plot-bootstrap-distribution-of-median-pairwise-differences" class="level4" data-number="7.8.2.1"><h4 data-number="7.8.2.1" class="anchored" data-anchor-id="plot-bootstrap-distribution-of-median-pairwise-differences">
<span class="header-section-number">7.8.2.1</span> Plot bootstrap distribution of median pairwise differences</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb47-2"><a href="#cb47-2"></a>nboot <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb47-3"><a href="#cb47-3"></a>aav <span class="ot">&lt;-</span> <span class="fl">0.05</span> <span class="co"># arbitrary alpha value</span></span>
<span id="cb47-4"><a href="#cb47-4"></a>diff <span class="ot">&lt;-</span> df1<span class="sc">$</span>session2 <span class="sc">-</span> df1<span class="sc">$</span>session1</span>
<span id="cb47-5"><a href="#cb47-5"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(diff)</span>
<span id="cb47-6"><a href="#cb47-6"></a><span class="co"># bootstrap sampling </span></span>
<span id="cb47-7"><a href="#cb47-7"></a>boot.diff <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">sample</span>(diff, <span class="at">size=</span>n<span class="sc">*</span>nboot, <span class="at">replace=</span><span class="cn">TRUE</span>), <span class="at">nrow=</span>nboot)</span>
<span id="cb47-8"><a href="#cb47-8"></a><span class="co"># compute medians for each bootstrap sample</span></span>
<span id="cb47-9"><a href="#cb47-9"></a>boot.diff.md <span class="ot">&lt;-</span> <span class="fu">apply</span>(boot.diff, <span class="dv">1</span>, median)</span>
<span id="cb47-10"><a href="#cb47-10"></a><span class="co"># confidence interval</span></span>
<span id="cb47-11"><a href="#cb47-11"></a>ci <span class="ot">&lt;-</span> <span class="fu">quantile</span>(boot.diff.md, <span class="at">probs =</span> <span class="fu">c</span>(aav<span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">-</span>aav<span class="sc">/</span><span class="dv">2</span>)) </span>
<span id="cb47-12"><a href="#cb47-12"></a><span class="co"># group median difference</span></span>
<span id="cb47-13"><a href="#cb47-13"></a>diff.md <span class="ot">&lt;-</span> <span class="fu">median</span>(diff)</span>
<span id="cb47-14"><a href="#cb47-14"></a></span>
<span id="cb47-15"><a href="#cb47-15"></a>ci1 <span class="ot">&lt;-</span> <span class="fu">round</span>(ci[<span class="dv">1</span>], <span class="at">digits=</span><span class="dv">2</span>)</span>
<span id="cb47-16"><a href="#cb47-16"></a>ci2 <span class="ot">&lt;-</span> <span class="fu">round</span>(ci[<span class="dv">2</span>], <span class="at">digits=</span><span class="dv">2</span>)</span>
<span id="cb47-17"><a href="#cb47-17"></a></span>
<span id="cb47-18"><a href="#cb47-18"></a>df <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">with</span>(<span class="fu">density</span>(boot.diff.md),<span class="fu">data.frame</span>(x,y)))</span>
<span id="cb47-19"><a href="#cb47-19"></a></span>
<span id="cb47-20"><a href="#cb47-20"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span> theme_gar <span class="sc">+</span></span>
<span id="cb47-21"><a href="#cb47-21"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> diff.md, <span class="at">colour =</span> <span class="st">"grey"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb47-22"><a href="#cb47-22"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb47-23"><a href="#cb47-23"></a>  <span class="co"># scale_x_continuous(breaks = seq(-200, 200, 20)) +</span></span>
<span id="cb47-24"><a href="#cb47-24"></a>  <span class="co"># coord_cartesian(xlim = c(-130, 0)) +</span></span>
<span id="cb47-25"><a href="#cb47-25"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Bootstrap median of pairwise differences"</span>, <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb47-26"><a href="#cb47-26"></a>    <span class="co"># confidence interval ----------------------</span></span>
<span id="cb47-27"><a href="#cb47-27"></a>  <span class="fu">geom_segment</span>(<span class="at">x =</span> ci[<span class="dv">1</span>], <span class="at">xend =</span> ci[<span class="dv">2</span>],</span>
<span id="cb47-28"><a href="#cb47-28"></a>               <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> <span class="dv">0</span>,</span>
<span id="cb47-29"><a href="#cb47-29"></a>               <span class="at">lineend =</span> <span class="st">"round"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">colour =</span> <span class="st">"orange"</span>) <span class="sc">+</span></span>
<span id="cb47-30"><a href="#cb47-30"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"label"</span>, <span class="at">x =</span> ci1, <span class="at">y =</span> <span class="fl">0.1</span><span class="sc">*</span><span class="fu">max</span>(df<span class="sc">$</span>y), <span class="at">size =</span> <span class="dv">7</span>,</span>
<span id="cb47-31"><a href="#cb47-31"></a>             <span class="at">colour =</span> <span class="st">"white"</span>, <span class="at">fill =</span> <span class="st">"orange"</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>,</span>
<span id="cb47-32"><a href="#cb47-32"></a>             <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"L = "</span>, <span class="fu">round</span>(ci1, <span class="at">digits =</span> <span class="dv">2</span>))) <span class="sc">+</span></span>
<span id="cb47-33"><a href="#cb47-33"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"label"</span>, <span class="at">x =</span> ci2, <span class="at">y =</span> <span class="fl">0.1</span><span class="sc">*</span><span class="fu">max</span>(df<span class="sc">$</span>y), <span class="at">size =</span> <span class="dv">7</span>,</span>
<span id="cb47-34"><a href="#cb47-34"></a>             <span class="at">colour =</span> <span class="st">"white"</span>, <span class="at">fill =</span> <span class="st">"orange"</span>, <span class="at">fontface =</span> <span class="st">"bold"</span>,</span>
<span id="cb47-35"><a href="#cb47-35"></a>             <span class="at">label =</span> <span class="fu">paste</span>(<span class="st">"U = "</span>, <span class="fu">round</span>(ci2, <span class="at">digits =</span> <span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure"><p><img src="02-08-gar-gpcomp_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="pdiff-0" class="level3" data-number="7.8.3"><h3 data-number="7.8.3" class="anchored" data-anchor-id="pdiff-0">
<span class="header-section-number">7.8.3</span> <span class="math inline">\(P(diff &gt; 0)\)</span>
</h3>
<p>In what proportion of participants is performance better in session 2?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>pdiff <span class="ot">&lt;-</span> df1<span class="sc">$</span>session2 <span class="sc">-</span> df1<span class="sc">$</span>session1</span>
<span id="cb48-2"><a href="#cb48-2"></a><span class="fu">mean</span>(pdiff <span class="sc">&gt;</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.74</code></pre>
</div>
</div>
</section><section id="pdiff-0-confidence-interval" class="level3" data-number="7.8.4"><h3 data-number="7.8.4" class="anchored" data-anchor-id="pdiff-0-confidence-interval">
<span class="header-section-number">7.8.4</span> <span class="math inline">\(P(diff &gt; 0)\)</span> + confidence interval</h3>
<p>Fancy a confidence interval for that interesting and perfectly legitimate quantity? The only thing we need is a function we can plug into <code>onesampb()</code>.</p>
<section id="define-function" class="level4" data-number="7.8.4.1"><h4 data-number="7.8.4.1" class="anchored" data-anchor-id="define-function">
<span class="header-section-number">7.8.4.1</span> Define function</h4>
<p>Probability that x is larger than zero.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>pxlz<span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb50-2"><a href="#cb50-2"></a>  <span class="fu">mean</span>(x <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb50-3"><a href="#cb50-3"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="percentile-bootstrap" class="level4" data-number="7.8.4.2"><h4 data-number="7.8.4.2" class="anchored" data-anchor-id="percentile-bootstrap">
<span class="header-section-number">7.8.4.2</span> Percentile bootstrap</h4>
<p>Note how argument <code>est</code> is set to our new quantity defined by function <code>pxlz</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="fu">onesampb</span>(pdiff, <span class="at">alpha=</span>.<span class="dv">05</span>, <span class="at">nboot=</span><span class="dv">2000</span>, <span class="at">est=</span>pxlz, <span class="at">null.value =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$ci
[1] 0.65 0.82

$n
[1] 100

$estimate
[1] 0.74

$p.value
[1] 0</code></pre>
</div>
</div>
</section></section></section><section id="references" class="level2" data-number="7.9"><h2 data-number="7.9" class="anchored" data-anchor-id="references">
<span class="header-section-number">7.9</span> References</h2>
<p>Rousselet, G. A., Pernet, C. R., &amp; Wilcox, R. R. (2017). Beyond differences in means: Robust graphical methods to compare two groups in neuroscience. European Journal of Neuroscience, 46(2), 1738–1748. https://doi.org/10.1111/ejn.13610</p>


</section></main><!-- /main --><script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  var t = document.getElementsByClassName("webex-total_correct");
  for (var i = 0; i < t.length; i++) {
    p = t[i].parentElement;
    var correct = p.getElementsByClassName("webex-correct").length;
    var solvemes = p.getElementsByClassName("webex-solveme").length;
    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;
    var selects = p.getElementsByClassName("webex-select").length;

    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* check answers */
check_func = function() {
  console.log("webex: check answers");

  var cl = this.parentElement.classList;
  if (cl.contains('unchecked')) {
    cl.remove("unchecked");
    this.innerHTML = "Hide Answers";
  } else {
    cl.add("unchecked");
    this.innerHTML = "Show Answers";
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  var check_sections = document.getElementsByClassName("webex-check");
  console.log("check:", check_sections.length);
  for (var i = 0; i < check_sections.length; i++) {
    check_sections[i].classList.add("unchecked");

    let btn = document.createElement("button");
    btn.innerHTML = "Show Answers";
    btn.classList.add("webex-check-button");
    btn.onclick = check_func;
    check_sections[i].appendChild(btn);

    let spn = document.createElement("span");
    spn.classList.add("webex-total_correct");
    check_sections[i].appendChild(spn);
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    solveme[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    selects[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  update_total_correct();
}

</script><script>
// open rdrr links externally ----

var exlinks = document.querySelectorAll("a[href^='https://rdrr.io']");
var exlink_func = function(){
  window.open(this.href);
  return false;
};
for (var i = 0; i < exlinks.length; i++) {
    exlinks[i].addEventListener('click', exlink_func, false);
}

// visible second sidebar in mobile ----

function move_sidebar() {
  var toc = document.getElementById("TOC");
  var small_sidebar = document.querySelector("#quarto-sidebar .sidebar-menu-container");
  var right_sidebar = document.getElementById("quarto-margin-sidebar");

  if (window.innerWidth < 768) {
    small_sidebar.append(toc);
  } else {
    right_sidebar.append(toc);
  }
}
move_sidebar();
window.onresize = move_sidebar;
</script><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./02-07-gar-ci.html" class="pagination-link" aria-label="Confidence Intervals">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Confidence Intervals</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link" aria-label="References">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>CC-BY (2025) Bartlett, Rousselet, &amp; DeBruine.</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>


</body></html>